<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6200EA">
    <meta name="description" content="FitTracker - Votre coach fitness personnel dans votre poche. Application PWA pour suivre vos entraînements et atteindre vos objectifs.">
    
    <title>FitTracker - Votre Coach Fitness Personnel</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <i class="fas fa-heartbeat splash-icon"></i>
            <h1 class="splash-title">FitTracker</h1>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- App Container -->
    <div id="app" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <button id="menu-toggle" class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="app-title">FitTracker</h1>
                <button id="notification-toggle" class="notification-toggle">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" style="display: none;"></span>
                </button>
            </div>
        </header>

        <!-- Navigation Drawer -->
        <nav id="nav-drawer" class="nav-drawer">
            <div class="drawer-header">
                <img src="icons/icon-192.png" alt="FitTracker" class="drawer-logo">
                <h2 class="drawer-title">FitTracker</h2>
                <button id="close-drawer" class="close-drawer">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <ul class="drawer-menu">
                <li><a href="#dashboard" class="drawer-link active"><i class="fas fa-chart-line"></i> Tableau de bord</a></li>
                <li><a href="#workouts" class="drawer-link"><i class="fas fa-dumbbell"></i> Entraînements</a></li>
                <li><a href="#exercises" class="drawer-link"><i class="fas fa-running"></i> Exercices</a></li>
                <li><a href="#progress" class="drawer-link"><i class="fas fa-chart-bar"></i> Progrès</a></li>
                <li><a href="#profile" class="drawer-link"><i class="fas fa-user"></i> Profil</a></li>
                <li><a href="#settings" class="drawer-link"><i class="fas fa-cog"></i> Paramètres</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main id="main-content" class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2 class="section-title">Tableau de bord</h2>
                    <span class="current-date" id="current-date"></span>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card calories">
                        <div class="stat-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value">0</span>
                            <span class="stat-label">Calories brûlées</span>
                        </div>
                        <div class="stat-progress">
                            <div class="progress-bar" style="width: 62%;"></div>
                        </div>
                    </div>

                    <div class="stat-card workouts">
                        <div class="stat-icon">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value">0</span>
                            <span class="stat-label">Entraînements cette semaine</span>
                        </div>
                        <div class="stat-progress">
                            <div class="progress-bar" style="width: 71%;"></div>
                        </div>
                    </div>

                    <div class="stat-card duration">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value">0m</span>
                            <span class="stat-label">Temps total</span>
                        </div>
                        <div class="stat-progress">
                            <div class="progress-bar" style="width: 80%;"></div>
                        </div>
                    </div>

                    <div class="stat-card goals">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value">0/5</span>
                            <span class="stat-label">Objectifs atteints</span>
                        </div>
                        <div class="stat-progress">
                            <div class="progress-bar" style="width: 60%;"></div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3 class="subsection-title">Actions rapides</h3>
                    <div class="action-buttons">
                        <button class="action-btn primary" id="start-workout">
                            <i class="fas fa-play"></i>
                            <span>Commencer l'entraînement</span>
                        </button>
                        <button class="action-btn secondary" id="view-schedule">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Programme</span>
                        </button>
                    </div>
                </div>

                <!-- Recent Activities -->
                <div class="recent-activities">
                    <h3 class="subsection-title">Activités récentes</h3>
                    <div class="activity-list">
                        <!-- Activities will be loaded here by UserManager -->
                        <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            <i class="fas fa-dumbbell" style="font-size: 48px; opacity: 0.3; margin-bottom: 20px;"></i>
                            <p>Aucune activité enregistrée</p>
                            <p style="font-size: 14px; margin-top: 10px;">Commencez votre premier entraînement!</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Workouts Section -->
            <section id="workouts" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Mes Entraînements</h2>
                    <button class="add-btn" id="add-workout">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>

                <!-- Workout Categories -->
                <div class="category-tabs">
                    <button class="tab-btn active">Tous</button>
                    <button class="tab-btn">Cardio</button>
                    <button class="tab-btn">Force</button>
                    <button class="tab-btn">Flexibilité</button>
                </div>

                <!-- Workout Grid -->
                <div class="workout-grid">
                    <div class="workout-card">
                        <div class="workout-header cardio">
                            <i class="fas fa-running"></i>
                        </div>
                        <div class="workout-content">
                            <h3 class="workout-title">HIIT Cardio</h3>
                            <p class="workout-description">Entraînement intensif par intervalles pour brûler un maximum de calories</p>
                            <div class="workout-info">
                                <span><i class="fas fa-clock"></i> 30 min</span>
                                <span><i class="fas fa-fire"></i> 350 kcal</span>
                                <span><i class="fas fa-signal"></i> Difficile</span>
                            </div>
                            <button class="start-btn">Commencer</button>
                        </div>
                    </div>

                    <div class="workout-card">
                        <div class="workout-header strength">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="workout-content">
                            <h3 class="workout-title">Push Day</h3>
                            <p class="workout-description">Entraînement ciblé pour pectoraux, épaules et triceps</p>
                            <div class="workout-info">
                                <span><i class="fas fa-clock"></i> 45 min</span>
                                <span><i class="fas fa-fire"></i> 280 kcal</span>
                                <span><i class="fas fa-signal"></i> Moyen</span>
                            </div>
                            <button class="start-btn">Commencer</button>
                        </div>
                    </div>

                    <div class="workout-card">
                        <div class="workout-header yoga">
                            <i class="fas fa-spa"></i>
                        </div>
                        <div class="workout-content">
                            <h3 class="workout-title">Yoga Flow</h3>
                            <p class="workout-description">Séance de yoga pour améliorer la flexibilité et réduire le stress</p>
                            <div class="workout-info">
                                <span><i class="fas fa-clock"></i> 40 min</span>
                                <span><i class="fas fa-fire"></i> 120 kcal</span>
                                <span><i class="fas fa-signal"></i> Facile</span>
                            </div>
                            <button class="start-btn">Commencer</button>
                        </div>
                    </div>

                    <div class="workout-card">
                        <div class="workout-header strength">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="workout-content">
                            <h3 class="workout-title">Full Body</h3>
                            <p class="workout-description">Entraînement complet du corps pour développer force et endurance</p>
                            <div class="workout-info">
                                <span><i class="fas fa-clock"></i> 60 min</span>
                                <span><i class="fas fa-fire"></i> 450 kcal</span>
                                <span><i class="fas fa-signal"></i> Difficile</span>
                            </div>
                            <button class="start-btn">Commencer</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Exercises Section -->
            <section id="exercises" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Bibliothèque d'Exercices</h2>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="search" placeholder="Rechercher un exercice..." id="exercise-search">
                    </div>
                </div>

                <!-- Exercise Filter -->
                <div class="filter-chips">
                    <button class="chip active">Tous</button>
                    <button class="chip">Pectoraux</button>
                    <button class="chip">Dos</button>
                    <button class="chip">Jambes</button>
                    <button class="chip">Épaules</button>
                    <button class="chip">Bras</button>
                    <button class="chip">Abdos</button>
                </div>

                <!-- Exercise List -->
                <div class="exercise-list">
                    <div class="exercise-item">
                        <div class="exercise-image">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="exercise-info">
                            <h4 class="exercise-name">Développé couché</h4>
                            <span class="muscle-group">Pectoraux</span>
                        </div>
                        <button class="info-btn">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>

                    <div class="exercise-item">
                        <div class="exercise-image">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="exercise-info">
                            <h4 class="exercise-name">Squat</h4>
                            <span class="muscle-group">Jambes</span>
                        </div>
                        <button class="info-btn">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>

                    <div class="exercise-item">
                        <div class="exercise-image">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="exercise-info">
                            <h4 class="exercise-name">Traction</h4>
                            <span class="muscle-group">Dos</span>
                        </div>
                        <button class="info-btn">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>

                    <div class="exercise-item">
                        <div class="exercise-image">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="exercise-info">
                            <h4 class="exercise-name">Développé militaire</h4>
                            <span class="muscle-group">Épaules</span>
                        </div>
                        <button class="info-btn">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>

                    <div class="exercise-item">
                        <div class="exercise-image">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="exercise-info">
                            <h4 class="exercise-name">Curl biceps</h4>
                            <span class="muscle-group">Bras</span>
                        </div>
                        <button class="info-btn">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>

                    <div class="exercise-item">
                        <div class="exercise-image">
                            <i class="fas fa-dumbbell"></i>
                        </div>
                        <div class="exercise-info">
                            <h4 class="exercise-name">Crunch</h4>
                            <span class="muscle-group">Abdos</span>
                        </div>
                        <button class="info-btn">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Progress Section -->
            <section id="progress" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Mon Progrès</h2>
                    <select class="period-selector">
                        <option>Cette semaine</option>
                        <option>Ce mois</option>
                        <option>Cette année</option>
                    </select>
                </div>

                <!-- Progress Charts -->
                <div class="chart-container">
                    <div class="chart-card">
                        <h3 class="chart-title">Évolution du poids</h3>
                        <canvas id="weight-chart" class="chart-canvas"></canvas>
                    </div>
                </div>

                <!-- Achievement Badges -->
                <div class="achievements">
                    <h3 class="subsection-title">Réussites débloquées</h3>
                    <div class="badge-grid">
                        <div class="achievement-badge earned">
                            <i class="fas fa-star"></i>
                            <span>Première semaine</span>
                        </div>
                        <div class="achievement-badge earned">
                            <i class="fas fa-fire"></i>
                            <span>1000 kcal brûlées</span>
                        </div>
                        <div class="achievement-badge earned">
                            <i class="fas fa-medal"></i>
                            <span>10 entraînements</span>
                        </div>
                        <div class="achievement-badge">
                            <i class="fas fa-trophy"></i>
                            <span>Objectif mensuel</span>
                        </div>
                    </div>
                </div>

                <!-- Personal Records -->
                <div class="personal-records">
                    <h3 class="subsection-title">Records personnels</h3>
                    <div class="record-list">
                        <div class="record-item">
                            <span class="record-exercise">Course 5K</span>
                            <span class="record-value">24:32</span>
                        </div>
                        <div class="record-item">
                            <span class="record-exercise">Développé couché</span>
                            <span class="record-value">80 kg</span>
                        </div>
                        <div class="record-item">
                            <span class="record-exercise">Squat</span>
                            <span class="record-value">120 kg</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Mon Profil</h2>
                    <button class="edit-btn" id="edit-profile">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>

                <div class="profile-card">
                    <div class="profile-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <h3 class="profile-name">Utilisateur</h3>
                    <span class="profile-level">Niveau Débutant</span>
                    
                    <div class="profile-stats">
                        <div class="profile-stat">
                            <span class="stat-value">0</span>
                            <span class="stat-label">Entraînements</span>
                        </div>
                        <div class="profile-stat">
                            <span class="stat-value">0</span>
                            <span class="stat-label">Calories brûlées</span>
                        </div>
                        <div class="profile-stat">
                            <span class="stat-value">0h</span>
                            <span class="stat-label">Temps total</span>
                        </div>
                    </div>
                </div>

                <!-- User Info -->
                <div class="user-info">
                    <div class="info-item">
                        <span class="info-label">Âge</span>
                        <span class="info-value">Non renseigné</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Poids</span>
                        <span class="info-value">Non renseigné</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Taille</span>
                        <span class="info-value">Non renseigné</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Objectif</span>
                        <span class="info-value">Forme générale</span>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">Paramètres</h2>
                </div>

                <div class="settings-list">
                    <div class="settings-group">
                        <h3 class="group-title">Notifications</h3>
                        <div class="setting-item">
                            <span class="setting-label">Notifications push</span>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Rappels d'entraînement</span>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3 class="group-title">Données</h3>
                        <div class="setting-item">
                            <span class="setting-label">Synchronisation automatique</span>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Mode hors-ligne</span>
                            <label class="switch">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3 class="group-title">Application</h3>
                        <button class="setting-btn" id="clear-cache">
                            <i class="fas fa-trash"></i>
                            Vider le cache
                        </button>
                        <button class="setting-btn" id="export-data">
                            <i class="fas fa-download"></i>
                            Exporter les données
                        </button>
                        <button class="setting-btn danger" id="reset-app">
                            <i class="fas fa-exclamation-triangle"></i>
                            Réinitialiser l'application
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-section="dashboard">
                <i class="fas fa-home"></i>
                <span>Accueil</span>
            </button>
            <button class="nav-item" data-section="workouts">
                <i class="fas fa-dumbbell"></i>
                <span>Entraînement</span>
            </button>
            <button class="nav-item workout-fab" id="quick-start">
                <i class="fas fa-play"></i>
            </button>
            <button class="nav-item" data-section="progress">
                <i class="fas fa-chart-bar"></i>
                <span>Progrès</span>
            </button>
            <button class="nav-item" data-section="profile">
                <i class="fas fa-user"></i>
                <span>Profil</span>
            </button>
        </nav>
    </div>

    <!-- Workout Modal -->
    <div id="workout-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Entraînement en cours</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="workout-timer">
                    <span id="timer">00:00</span>
                </div>
                <div class="current-exercise">
                    <h4>Pompes</h4>
                    <p>3 séries de 15 répétitions</p>
                </div>
                <div class="exercise-progress">
                    <span>Série 1/3</span>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: 33%;"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="pause-workout">
                    <i class="fas fa-pause"></i> Pause
                </button>
                <button class="btn-primary" id="next-exercise">
                    Suivant <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Install PWA Toast -->
    <div id="install-toast" class="install-toast" style="display: none;">
        <div class="toast-content">
            <i class="fas fa-download"></i>
            <span>Installer l'application pour un accès rapide</span>
            <button id="install-btn" class="install-btn">Installer</button>
            <button id="dismiss-btn" class="dismiss-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <!-- User Manager first -->
    <script src="js/user-manager.js"></script>
    <!-- Main App -->
    <script src="js/app.js"></script>
    <!-- Initialization Fix to ensure empty state -->
    <script src="js/init-fix.js"></script>
    
    <!-- Chart.js for progress charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Activity Recording Functions -->
    <script>
        // Add new workout activity
        function startWorkout() {
            const workoutModal = `
                <div id="workout-start-modal" class="modal active">
                    <div class="modal-content">
                        <h3>Enregistrer un entraînement</h3>
                        <form id="workout-form" style="padding: 20px 0;">
                            <div style="margin-bottom: 15px;">
                                <label>Type d'entraînement</label>
                                <select id="workout-type" style="width: 100%; padding: 10px; background: var(--surface-light); border: 1px solid var(--surface-light); border-radius: 8px; color: white;">
                                    <option value="cardio">Cardio</option>
                                    <option value="strength">Musculation</option>
                                    <option value="yoga">Yoga</option>
                                    <option value="cycling">Vélo</option>
                                    <option value="swimming">Natation</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label>Nom de l'activité</label>
                                <input type="text" id="workout-name" placeholder="Ex: Course matinale" required
                                       style="width: 100%; padding: 10px; background: var(--surface-light); border: 1px solid var(--surface-light); border-radius: 8px; color: white;">
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                                <div>
                                    <label>Durée (min)</label>
                                    <input type="number" id="workout-duration" placeholder="30" required
                                           style="width: 100%; padding: 10px; background: var(--surface-light); border: 1px solid var(--surface-light); border-radius: 8px; color: white;">
                                </div>
                                <div>
                                    <label>Calories</label>
                                    <input type="number" id="workout-calories" placeholder="250"
                                           style="width: 100%; padding: 10px; background: var(--surface-light); border: 1px solid var(--surface-light); border-radius: 8px; color: white;">
                                </div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label>Distance (km) - optionnel</label>
                                <input type="number" step="0.1" id="workout-distance" placeholder="5.5"
                                       style="width: 100%; padding: 10px; background: var(--surface-light); border: 1px solid var(--surface-light); border-radius: 8px; color: white;">
                            </div>
                            <div style="display: flex; gap: 15px;">
                                <button type="button" onclick="closeWorkoutModal()"
                                        style="flex: 1; padding: 12px; background: var(--surface-light); color: white; border: none; border-radius: 8px; cursor: pointer;">
                                    Annuler
                                </button>
                                <button type="submit"
                                        style="flex: 1; padding: 12px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer;">
                                    Enregistrer
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', workoutModal);
            
            document.getElementById('workout-form').addEventListener('submit', (e) => {
                e.preventDefault();
                saveWorkout();
            });
        }
        
        function closeWorkoutModal() {
            const modal = document.getElementById('workout-start-modal');
            if (modal) modal.remove();
        }
        
        function saveWorkout() {
            if (!userManager) {
                alert('Veuillez d\'abord configurer votre profil');
                return;
            }
            
            const activity = {
                type: document.getElementById('workout-type').value,
                name: document.getElementById('workout-name').value,
                duration: parseInt(document.getElementById('workout-duration').value),
                calories: parseInt(document.getElementById('workout-calories').value) || 0,
                distance: parseFloat(document.getElementById('workout-distance').value) || null
            };
            
            userManager.addActivity(activity);
            closeWorkoutModal();
            showNotification('Entraînement enregistré! 💪');
            
            // Refresh the dashboard
            if (typeof userManager.updateUI === 'function') {
                userManager.updateUI();
            }
        }
        
        // Override the original startWorkout if needed
        if (document.getElementById('start-workout')) {
            document.getElementById('start-workout').onclick = startWorkout;
        }
    </script>
</body>
</html>